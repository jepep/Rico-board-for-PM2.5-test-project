#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/types.h>                                                 
#include <sys/stat.h>                                                      
#include <termios.h>
#include <unistd.h>
#include <time.h>
#include <errno.h>
#include <string.h>
#define NUM 256
main()
{
   int fd,i;
   char buf[NUM];
   struct termios tio
   int nreadlen = NUM;
  // if((fd=open("/dev/ttyUSB0",O_RDWR|O_NDELAY|O_NOCTTY))<0)  
   if((fd=open("/dev/ttyUSB0",O_RDWR))<0)
   {
      printf("could not open\n");
      exit(1);
   }
   else
    {
      printf("comm open success\n");
    }
tio.c_cflag=B115200|CS8|CREAD|CLOCAL;
        tio.c_cflag &= ~CRTSCTS;
  //Amend the output model, original data output' }
  tio.c_oflag &= ~OPOST;}

  tio.c_lflag &= ~(ICANON | ECHO | ECHOE | ISIG);//This is what I added 
//options.c_lflag &= ~(ISIG | ICANON);
        {// 0x11 send
                tio.c_lflag &= ~(ICANON );
                tio.c_lflag &= ~(ICANON |ISIG);
                tio.c_iflag &= ~(BRKINT | ICRNL | INPCK | ISTRIP | IXON);
        }
    //Set wait time and minimum receive character
//tio.c_cflag=B9600|CS8|CREAD|CLOCAL;
// tio.c_cflag&=~HUPCL;
  tio.c_lflag=0;
  tio.c_iflag=IGNPAR;
  tio.c_oflag=0;
  tio.c_cc[VTIME]=10;
  tio.c_cc[VMIN]=16;
  
  tcflush(fd,TCIFLUSH);
  tcsetattr(fd,TCSANOW,&tio);
  fcntl(fd,F_SETFL,FNDELAY);
  
  while(1)
{
        memset(buf, '\0', NUM);
    i=read(fd,buf, nreadlen);
    if(i>0)
    {
      // write(fd,buf,1);
      printf("---read <%s> from serial port ttyUSB0\n", buf)
    }
}
close (fd);
}
